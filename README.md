# EdukaExploits

This is a collection of various exploits that have been discovered on the [Eduka](https://klase.eduka.lt/) platform.

I hope that making these exploits easily accessible will force the devs of Eduka to consider patching them and making safer systems in the future.

---

## About

There are 2 types of exploits that I have discovered on Eduka platform. In this repo both of them have separate folders created, with the usage, how-to's and requirements described in them.

Here is a short description about both of them:

### Internal API

This exploit uses the internal Eduka api which can be found at [this](https://klase.eduka.lt/api/) (`https://klase.eduka.lt/api/`) endpoint. This type of exploit requires authentication (meaning that you will have to login into an Eduka account or use another type of authentication). This internal api exposes a lot of information about the user account, and quizzes that are assigned to the account. This vulnerability can be taken advantage of from any code or app that can send basic http requests.

### "mauthor" iframe

This exploit uses the JS functions that are loaded client side on an Eduka iframe called "mauthor". Functions in this iframe are responsible for loading quiz questions, storing and scoring the answers and a lot more. A lot of these functions require reverse engineering, but with enough effort they can be figured out and called forcibly, resulting in unexpected behavior from Eduka platform. This vulnerability can be exploited simply by using dev console or by injecting malicious JS into page at runtime (see an example chrome extension that uses this vuln here: [EdukaScores](https://github.com/Adomas-Alimas/EdukaScores)).


















---

This is a collection of `python3` classes that take advantage of various `https://klase.eduka.lt/api/` api exploits. They are intended to be used by developers for easier creation of various automated answer checking, correct answer guessing and similar apps.

I also hope that as a result of making these exploits more accessible, the devs of Eduka will consider patching them and making safer systems in the future.

## About

It seems that the Eduka platform internal api that handles quiz answers, students answered questions, scoring and other internal functions is public and easily accessible. In fact all of the available classes in this repo just use requests lib to abstract and simplify info gathering from various api endpoints. The only requirements for accessing the internal api are:

- Eduka platform authentication
- Correct api endpoint
- Test id for which the api will be quarried

## Classes

This repo provides the following exploit classes:

- [internal_scores](internal_scores) - used for accessing internal scoring api, which is used by Eduka platform to determine how many 'points' for each answer the student will get.

Each of them uses a different method to gather different (and sometimes similar) data. More in-depth description of each class and it's usage can be found in respective file DOCSTRINGS.

## General knowledge, tips, etc

### Structure

Each of the provided `.py` file has a `Handler()` class inside of it. This class contains methods for all functions (authentication, data retrieval, data parsing, etc..) that are required for the specific api endpoint exploitation. These methods are not definitive, you might have to modify them or create new ones depending on your needs.

### Authentication

For any access to the Eduka api an authenticated session is needed. Authentication can be achieved in 2 ways:

- **Authentication with normal user credentials (username and password)** - This type of authentication is the most simple, it is done by initializing `Handler()` class with `username` and `password` arguments. These credentials are then used to create a new session. **Keep in mind that this type of authentication will log out all other devices that have used the same credentials to log into Eduka.**
- **Authentication using live session id** - This type of authentication involves manually or automatically (check out [browser_cookie3](https://github.com/borisbabic/browser_cookie3) for a possible solution) searching the browsers cookies for `PHPSESSID` cookie, retrieving it's value and using it as the `sessid` argument in `Handler()` initialization. While this is harder to do, it has a very nice advantage - **it doesn't log out any other devices or even live sessions in browser from the Eduka platform.**

If no auth arguments are passed to `Handler()` during initialization, `TypeError` is raised.

### API endpoints

The following endpoints are known:

- *<https://klase.eduka.lt/api/student/quiz-templates/data/{test_ID}/sprendimas>*
- *<https://klase.eduka.lt/api/student/quiz-templates/task-package-content/{test_ID}>*
- *<https://klase.eduka.lt/api/student/quiz-templates/result-xml/{test_ID}/perziura>*

### Test_id

All of the endpoints above require a valid `test_ID`. A `test_ID` is a specific 8 number code that is used for internal Eduka reference to the test instance that is being solved. It can be found in browser URL after the test has been started. It looks like this:

```text
https://klase.eduka.lt/student/lesson-material/show/27980981/3629303/1
                                                    ▲▲▲▲▲▲▲▲
                                                    test_ID
```

---

## Credits

- Original exploit finder unknown.
- [ignuxas](https://github.com/ignuxas/) - specific api endpoints.
- unnamed friends.
